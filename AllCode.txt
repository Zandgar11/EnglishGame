script.js ==>
let songs = [];
let currentSong = null;
let timerDuration = 30;
let timeLeft = 0;
let interval = null;
let isPaused = false;

const takeCardBtn = document.getElementById("takeCard");
const hideCardBtn = document.getElementById("hideCard");
const startTimerBtn = document.getElementById("startTimer");
const cardText = document.getElementById("cardText");
const difficultySelect = document.getElementById("difficulty");
const timer1 = document.getElementById("timer1");
const timer2 = document.getElementById("timer2");
const team1 = document.getElementById("team1");
const team2 = document.getElementById("team2");
let popup = null;
let endOverlay = null;

// === Chargement du JSON ===
fetch("convertcsv.json")
  .then(r => r.json())
  .then(data => {
    if (!data || !data.length) throw new Error("Fichier vide");
    if (Array.isArray(data[0])) {
      const keys = ["Titre", "Ann√©e", "Artiste", "Difficult√©"];
      songs = data.map(row => {
        const obj = {};
        keys.forEach((k, i) => (obj[k] = row[i]));
        return obj;
      });
    } else if (typeof data[0] === "object") {
      songs = data;
    } else {
      throw new Error("Format JSON inconnu");
    }
    console.log(`‚úÖ ${songs.length} chansons charg√©es`);
  })
  .catch(err => {
    console.error("Erreur chargement JSON :", err);
    showNotice("‚ö†Ô∏è Erreur : impossible de charger les chansons !");
  });

// === Gestion des cartes ===
takeCardBtn.addEventListener("click", () => {
  if (!songs.length) {
    showNotice("‚è≥ Les chansons ne sont pas encore charg√©es !");
    return;
  }
  const diff = difficultySelect.value.toLowerCase();
  switch (diff) {
    case "easy": timerDuration = 60; break;
    case "medium": timerDuration = 75; break;
    case "hard": timerDuration = 90; break;
  }
  const filtered = songs.filter(s => (s.Difficult√© || "").trim().toLowerCase() === diff);
  if (!filtered.length) {
    showNotice("üòï Aucune chanson trouv√©e pour cette difficult√© !");
    return;
  }
  currentSong = filtered[Math.floor(Math.random() * filtered.length)];
  cardText.textContent = `${currentSong.Titre} ‚Äî ${currentSong.Artiste} (${currentSong.Difficult√©})`;
  cardText.style.filter = "blur(0)";
  hideCardBtn.style.display = "block";
  startTimerBtn.disabled = false;
});

hideCardBtn.addEventListener("click", () => {
  cardText.style.filter = "blur(20px)";
  hideCardBtn.style.display = "none";
});

startTimerBtn.addEventListener("click", () => {
  startTimerBtn.disabled = true;
  startTimer();
});

// === Timer ===
function startTimer() {
  timeLeft = timerDuration;
  updateTimers();
  if (interval) clearInterval(interval);
  interval = setInterval(() => {
    if (!isPaused) {
      timeLeft--;
      updateTimers();
    }
    if (timeLeft <= 0) {
      clearInterval(interval);
      interval = null;
      showNotice("‚è∞ Temps √©coul√© !");
      showSongPopup(); // popup de fin
      startTimerBtn.disabled = false;
    }
  }, 1000);
}

function updateTimers() {
  timer1.textContent = timeLeft.toString().padStart(2, "0");
  timer2.textContent = timeLeft.toString().padStart(2, "0");
}

// === Buzzer ===
function buzz(team) {
  if (isPaused || timeLeft <= 0) return;
  team.classList.add("buzzed");
  setTimeout(() => team.classList.remove("buzzed"), 400);
  isPaused = true;
  showPopup(team);
}

team1.addEventListener("click", () => buzz(team1));
team2.addEventListener("click", () => buzz(team2));

function showPopup(team) {
  if (popup) popup.remove();
  popup = document.createElement("div");
  popup.className = "popup";
  popup.innerHTML = `
    <div class="popup-inner">
      <h3>${team === team1 ? "Team 1" : "Team 2"} buzzed!</h3>
      <button id="yesBtn">‚úÖ Correct answer</button>
      <button id="noBtn">‚ùå Wrong answer</button>
    </div>
  `;
  document.body.appendChild(popup);

  document.getElementById("yesBtn").addEventListener("click", () => {
    endRound(team);
  });

  document.getElementById("noBtn").addEventListener("click", () => {
    const otherTeam = team === team1 ? team2 : team1;
    endRound(otherTeam);
  });
}

// === Fin de manche ===
function endRound(team) {
  if (popup) popup.remove();
  popup = null;
  isPaused = false;
  clearInterval(interval);
  showEndOverlay(team === team1 ? "Team 1" : "Team 2", currentSong);
  startTimerBtn.disabled = false;
}

function showEndOverlay(teamName, song) {
  if (endOverlay) endOverlay.remove();
  endOverlay = document.createElement("div");
  endOverlay.className = "end-overlay";
  endOverlay.innerHTML = `
    <div class="end-inner">
      <h2>üèÜ ${teamName} wins the round!</h2>
      ${song ? `<p class="song-info"><strong>${song.Titre}</strong><br>${song.Artiste} (${song.Ann√©e})</p>` : ""}
      <button id="closeEndBtn">Next round</button>
    </div>
  `;
  document.body.appendChild(endOverlay);
  document.getElementById("closeEndBtn").addEventListener("click", () => {
    endOverlay.classList.add("fade-out");
    setTimeout(() => endOverlay.remove(), 400);
  });
}

// === Popup de fin de timer ===
function showSongPopup() {
  if (popup) popup.remove();
  popup = document.createElement("div");
  popup.className = "popup";
  popup.innerHTML = `
    <div class="popup-inner song-popup">
      <h2>‚è∞ Time‚Äôs up!</h2>
      ${currentSong ? `
        <p><strong>${currentSong.Titre}</strong><br>
        ${currentSong.Artiste} (${currentSong.Ann√©e})</p>
      ` : `<p>(No song active)</p>`}
      <button id="closeSongPopup">Close</button>
    </div>
  `;
  document.body.appendChild(popup);
  document.getElementById("closeSongPopup").addEventListener("click", () => {
    popup.classList.add("fade-out");
    setTimeout(() => popup.remove(), 400);
  });
}

// === Notifications ===
function showNotice(text) {
  const div = document.createElement("div");
  div.className = "notice";
  div.textContent = text;
  document.body.appendChild(div);
  setTimeout(() => div.classList.add("visible"), 10);
  setTimeout(() => {
    div.classList.remove("visible");
    setTimeout(() => div.remove(), 400);
  }, 2500);
}

// === Texte du r√®glement ===
const reglementText = `
<h2>üìú Songtionnary Duel Rules</h2>
<ol style="text-align:left; padding-left:20px;">
  <li>A team draws a song based on the chosen difficulty.</li>
  <li>The player must make their team guess the song title by drawing ‚Äî no words, no letters, no talking.</li>
  <li>If the opposing team guesses before time runs out, they can buzz.</li>
  <li>A correct answer = 1 point. A wrong answer = 1 point for the other team.</li>
  <li>When the round ends ‚Üí draw a new song.</li>
</ol>
<p style="font-weight:600; color:#0077b6;">Have fun and play fair üé∂</p>
`;

// === Petit bouton flottant ===
const tinyBtn = document.createElement("button");
tinyBtn.id = "tinyRuleBtn";
tinyBtn.title = "Show rules";
tinyBtn.textContent = "üìú";
document.body.appendChild(tinyBtn);

tinyBtn.addEventListener("click", () => {
  showReglementPopup();
});

// === Affichage du r√®glement ===
function showReglementPopup() {
  if (popup) popup.remove();
  popup = document.createElement("div");
  popup.className = "popup";
  popup.innerHTML = `
    <div class="popup-inner">
      ${reglementText}
      <button id="closeReglement">Close</button>
    </div>
  `;
  document.body.appendChild(popup);
  document.getElementById("closeReglement").addEventListener("click", () => {
    popup.classList.add("fade-out");
    setTimeout(() => popup.remove(), 400);
  });
}


styles.css ==>
:root {
  --blue1: #023e8a;
  --blue2: #0077b6;
  --blue3: #00b4d8;
  --white: #fefefe;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: "Segoe UI", Arial, sans-serif;
  background: var(--white);
  overflow: hidden;
  touch-action: manipulation;
  -webkit-user-select: none;
  user-select: none;
}

#game-area {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

.team {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  text-align: center;
  position: relative;
  cursor: pointer;
  transition: 0.2s ease;
  font-size: clamp(1.2rem, 4vw, 2rem);
  padding: 10px;
}

.team1 { background: var(--blue1); }
.team2 { background: var(--blue2); }

.team.buzzed {
  background: var(--blue3);
  transform: scale(1.03);
}

.team .overlay {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

.card-zone {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--white);
  color: var(--blue1);
  text-align: center;
  width: 92%;
  max-width: 400px;
  padding: 18px;
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.15);
  z-index: 5;
}

.card-zone h1 {
  margin-top: 0;
  color: var(--blue2);
  font-size: clamp(1.2rem, 5vw, 1.8rem);
}

select, button {
  width: 100%;
  margin: 8px 0;
  padding: 14px;
  border-radius: 12px;
  border: 2px solid var(--blue2);
  font-weight: 600;
  font-size: 1.1rem;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

button {
  background: var(--blue3);
  color: white;
  border: none;
  cursor: pointer;
  transition: 0.2s;
}

button:hover:not(:disabled),
button:active:not(:disabled) {
  background: var(--blue2);
  transform: scale(0.98);
}

button:disabled {
  background: #ccc;
  cursor: default;
}

#cardText {
  margin-top: 16px;
  font-size: 1.2rem;
  font-weight: 600;
  transition: filter 0.3s ease;
  word-wrap: break-word;
}

#timer1, #timer2 {
  font-size: clamp(1.8rem, 6vw, 2.6rem);
  font-weight: 700;
  margin: 0;
  text-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
  backdrop-filter: blur(2px);
}

.popup-inner {
  background: white;
  color: #023e8a;
  padding: 24px 20px;
  border-radius: 12px;
  text-align: center;
  width: 80%;
  max-width: 320px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.popup-inner h3 {
  margin-top: 0;
  margin-bottom: 15px;
  font-size: clamp(1.2rem, 5vw, 1.6rem);
}

.popup-inner button {
  margin: 6px;
  padding: 14px 18px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  color: white;
  font-size: 1.1rem;
  min-width: 100px;
}

#yesBtn { background: #2a9d8f; }
#noBtn { background: #e63946; }

@media (max-height: 600px) {
  .card-zone {
    padding: 12px;
  }
  select, button {
    padding: 10px;
    font-size: 0.95rem;
  }
}

.end-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  animation: fadeIn 0.3s ease forwards;
}

.end-overlay.fade-out {
  animation: fadeOut 0.4s ease forwards;
}

.end-inner {
  background: var(--white);
  color: var(--blue1);
  padding: 30px 20px;
  border-radius: 16px;
  text-align: center;
  width: 80%;
  max-width: 340px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  animation: popUp 0.4s ease;
}

.end-inner h2 {
  margin-top: 0;
  color: var(--blue2);
  font-size: 1.6rem;
}

.song-info {
  margin: 12px 0 20px;
  font-size: 1.1rem;
}

#closeEndBtn {
  background: var(--blue3);
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: 0.25s;
}

#closeEndBtn:hover {
  background: var(--blue2);
}

@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
@keyframes fadeOut { from {opacity:1;} to {opacity:0;} }
@keyframes popUp {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.notice {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translate(-50%, 100%);
  background: var(--blue2);
  color: white;
  padding: 12px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  opacity: 0;
  transition: 0.4s ease;
  z-index: 2000;
  font-weight: 600;
}

.notice.visible {
  transform: translate(-50%, 0);
  opacity: 1;
}

#Reglement {
  background: var(--blue1);
  color: white;
  border: none;
  font-weight: 600;
  border-radius: 10px;
}

#Reglement:hover {
  background: var(--blue2);
}

#tinyRuleBtn {
  position: fixed;
  top: 10px;
  right: 10px;
  background: var(--blue1);
  color: white;
  border: none;
  border-radius: 50%;
  width: 42px;
  height: 42px;
  font-size: 1.3rem;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 3px 8px rgba(0,0,0,0.25);
  transition: 0.2s ease;
  z-index: 10000;
}
#tinyRuleBtn:hover {
  background: var(--blue2);
  transform: scale(0.95);
}


index.html ==>
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Songtionnary Duel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <div id="game-area">
    <!-- √âquipe 1 -->
    <div class="team team1" id="team1">
      <div class="overlay">
        <h2>Team 1</h2>
        <p id="timer1">00</p>
      </div>
    </div>

    <!-- Zone centrale -->
    <div class="card-zone" id="cardZone">
      <h1>Songtionnary</h1>
      <button id="tinyRuleBtn" title="Show rules">üìú</button>
      <label for="difficulty">Choose the difficulty :</label>
      <select id="difficulty">
        <option value="Easy">Easy</option>
        <option value="Medium">Medium</option>
        <option value="Hard">Hard</option>
      </select>
      <button id="takeCard">Take a card</button>
      <p id="cardText"></p>
      <button id="hideCard" style="display:none;">Hide the card</button>
      <button id="startTimer" disabled>Start the timer</button>
    </div>

    <!-- √âquipe 2 -->
    <div class="team team2" id="team2">
      <div class="overlay">
        <h2>Team 2</h2>
        <p id="timer2">00</p>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
